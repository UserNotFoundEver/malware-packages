import tkinter as tk
from tkinter import messagebox
import security_checker

def check_package():
    package_name = entry.get()
    if not package_name:
        messagebox.showwarning("Input Error", "Please enter a package name.")
        return

    results = security_checker.main(package_name)
    output_text.delete(1.0, tk.END)
    if "malicious_warning" in results:
        output_text.insert(tk.END, results["malicious_warning"] + "\n\n")
    if "metadata_error" in results:
        output_text.insert(tk.END, results["metadata_error"] + "\n\n")
    if "metadata" in results:
        output_text.insert(tk.END, "Package Metadata:\n")
        for key, value in results["metadata"].items():
            output_text.insert(tk.END, f"{key}: {value}\n")
        output_text.insert(tk.END, "\n")
    if "static_analysis" in results:
        output_text.insert(tk.END, "Static Analysis:\n")
        output_text.insert(tk.END, results["static_analysis"] + "\n\n")
    if "community_reviews" in results:
        output_text.insert(tk.END, "Community Reviews:\n")
        for review in results["community_reviews"]:
            output_text.insert(tk.END, review + "\n")

# Create the main window
root = tk.Tk()
root.title("Python Package Security Checker")

# Create and place the widgets
tk.Label(root, text="Enter package name:").pack(pady=10)
entry = tk.Entry(root, width=50)
entry.pack(pady=5)

check_button = tk.Button(root, text="Check Package", command=check_package)
check_button.pack(pady=10)

output_text = tk.Text(root, wrap=tk.WORD, height=20, width=80)
output_text.pack(pady=10)

# Run the application
root.mainloop()
